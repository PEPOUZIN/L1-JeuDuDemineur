/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Jeu;

//Ceci importe la classe Scanner du package java.util
import java.util.Scanner;
//Ceci importe toutes les classes du package java.util
import java.util.*;
import java.util.regex.*;

/**
 * ?
 *
 * @author pp541251
 */
public class Jeu {                                                              //Cette classe permettra de pouvoir lancer une partie

    public Jeu() {                                                              //On appel une m√©thode qui fera un affichage au lancement de la classe Jeu
        Start();
    }

    public void Start() {                                                                                   //Cette m√©thode est √† but d√©coratif
        System.out.println("üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©");                               
        System.out.println("üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£");
        System.out.println("=========================Jeu du D√©mineur=============================");
        System.out.println("üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£");
        System.out.println("üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©");
        Scanner scan = new Scanner(System.in);                                                              //On ouvre un scanner 
        System.out.println("Voulez-vous jouez ?");                                                          //Et on demande au joueur de saisir une entr√©e
        String n = scan.nextLine();                                                                         //On lit la prochaine ligne

        if (n.matches("Oui")) {                                                                             //On v√©rifie avec un Regex que le joueur a marqu√© Oui

            System.out.println("üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©");

            System.out.println("Choisisser une difficult√© (1 √† 9)");                                        //On demande apr√®s √† l'utilisateur la difficult√© qu'il voudra dans son jeu
            String str = "";
            do {                                                                                            //Si l'utilisateur ne met pas une difficult√© entre 1 et 9
                Scanner sc = new Scanner(System.in);                                                        //Alors on lui redemendera
                str = sc.nextLine();                                                                        
            } while (!str.matches("[1-9]"));                                                                //V√©rification que se soit bien un chiffre
            int difficult = Integer.parseInt(str);

            System.out.println("üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©");

            System.out.println("Choisisser un nombre de ligne");                                            //On demande ensuite √† l'utilisateur le nombre de lignes dans le Plateau    
            String stra = "";                                                                               //Biens√ªr s'il ne met que des lettres, cela ne fonctionnera pas
            do {                                                                                            //Et donc, on l'emp√™che de mettre des lettres gr√¢ce au REGEX        
                Scanner sca = new Scanner(System.in);
                stra = sca.nextLine();
            } while (!stra.matches("[0-9]*"));                                                              //[0-9] v√©rifie que ce que l'utilisateur marque se situe entre 0 et 9
            int ligne = Integer.parseInt(stra);                                                             //Et * signifie qu'il peut marquer un chiffre 1 fois ou plus, soit l'intervalle => {1,}
                                                                                                            //Au lieu d'utiliser NextInt(), on d√©cide de montrer nos comp√©tences en transformant le String en entier
            System.out.println("üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©");

            System.out.println("Choisisser un nombre de colonne");                                          //Le nombre de colonnes du Plateau est ensuite demand√© au joueur
            String strab = "";                                                                              //On r√©it√©re la m√™me m√©thode que pr√©c√©damment
            do {
                Scanner scab = new Scanner(System.in);
                strab = scab.nextLine();
            } while (!stra.matches("[0-9]*"));
            int colonne = Integer.parseInt(strab);

            System.out.println("üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©üö©");

            System.out.println("\n");
            Plateau j = new Plateau(ligne, colonne, difficult);                                             //On construit le plateau avec les param√®tres de l'utilisateurs
            j.initPlateu();                                                                                 //On appel la m√©thode de la classe Plateau permettant de le cr√©er avec les Mines et les Cases Vides
            System.out.println(j.toString());                                                               //Ensuite la m√©thode toString() sera appel√© afin d'afficher dans le terminal le Plateau

            int compteurDrap = 0;                                                                           //Compte les drapeaux que l'on pose
            compteurDrap = j.getNbDrapeauR();                                                               

            while (!j.isVoD()) {                                                                            //Tant que la condition de victoire n'est pas respect√©
                System.out.println("Choisissez une option");                                                //Alors on continu d'afficher ce menu
                System.out.println("1-Choisir une case √† d√©couvrir");
                System.out.println("2-Posez un drapeau");
                System.out.println("3-Drapeau √† enlever");
                System.out.println("4-Quitter le jeu");

                String stchoix = "";
                do {
                    Scanner schoix = new Scanner(System.in);                                                //On ouvre un sacnner afin de v√©rifier que le joueur rentre bien un nombre entre 1 et 4
                    stchoix = schoix.nextLine();
                } while (!stchoix.matches("[1234]"));//Verification
                int choix = Integer.parseInt(stchoix);

                switch (choix) {                                                                            //On v√©rifie gr√¢ce √† un switch le choix de l'utilisateur
                    case 1:                                                                                 //S'il a voulu d√©couvrir un =e case, alors:
                        System.out.println("Choisir une case √† d√©couvrir");
                        String sx = "";
                        int x;                                                                              //On lui demande de saisir x    
                        do {
                            sx = ChoisirCaseX();
                            x = Integer.parseInt(sx);
                        } while (x > ligne - 1);                                                            //en v√©rifiant que celui-ci ne soit pas dehors
                        String sy = "";
                        int y;                                                                              //On fait de m√™me pour y
                        do {
                            sy = ChoisirCaseY();
                            y = Integer.parseInt(sy);
                        } while (y > colonne - 1);
                        if (j.getCasePlateau(x, y).isVisible()) {                                           //On v√©rifie que la Case jou√© ne soit pas encore d√©couverte    

                            System.out.println("Case d√©j√† d√©couverte");                                     //Si c'est le cas, alors on affiche un messsage d'erreur
                            break;
                        } else {

                            j.Decouvrir(x, y);                                                              //Sinon on appel une m√©thode qui permettra de d√©couvrir la Case
                            System.out.println(j.toString());
                            break;
                        }

                    case 2:                                                                                 //Si on a choisit de poser un drapeau
                        if (compteurDrap > 0) {                                                             //Et que le nombre de Drapeaux pos√©s n'est pas sup√©rieurs aux nombres de Mines sur le Terrain
                            System.out.println("Choisir une drapeau a poser");                              //Alors on demande √† l'utlisateur les coordonn√©e de celui-ci
                            String ssx = ChoisirCaseX();
                            int xx = Integer.parseInt(ssx);
                            String ssy = ChoisirCaseY();
                            int yy = Integer.parseInt(ssy);
                            j.getCasePlateau(xx, yy).setFlag(true);
                            System.out.println(j.toString());
                            compteurDrap = j.getNbDrapeauR() - 1;                                           //Toute en itt√©rant au compteur un drapeau disponible
                        } else {
                            System.out.println("Vous n'avez plus de drapeau \n");                           //Dans le cas o√π la condition du dessus n'est pas respect√©, c√†d que le nombre de drapeaux est √©gale au nombre de Mines alors On ne peut plus en poser    
                        }
                        break;
                    case 3:
                        if (compteurDrap >= j.getNbDrapeauR()) {                                            //Si l'utilisateur veut enlever un drapeau
                            System.out.println("Vous n'avez pas de drapeau sur le terrain \n");             //On v√©rifie qu'il y en d√©j√† un sur le Plateau et dans le cas contraire on affiche un message d'erreur
                        } else {
                            System.out.println("Choisir une drapeau a enlever");                            //Sinon on demande les coordonn√©es de celui-ci
                            String sssx = ChoisirCaseX();
                            int xxx = Integer.parseInt(sssx);
                            String sssy = ChoisirCaseY();
                            int yyy = Integer.parseInt(sssy);
                            j.getCasePlateau(xxx, yyy).setFlag(false);                                      //Gr√¢ce √† l'accesseur en √©criture, on peut enlever le Drapeau sur cette case
                            System.out.println(j.toString());                                               //Sans oublier d'appeler la m√©thode toString() afin de r√©afficher la case
                            compteurDrap = j.getNbDrapeauR() + 1;                                           //Le nombre de Drapeau gagne 1 afin de pouvoir en reposer
                        }

                        break;
                    case 4:                                                                                 //Dans le cas o√π l'utilisateur veut quitter la partie alors System.exit(0) le fera
                        System.exit(0);
                        break;
                }

            }
            System.out.println("üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£");
            System.out.println("=====================Voulez vous rejouer ?===========================");            //A la fin, nous demandons tout de m√™me si le joueur veut rejouer
            System.out.println("üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£üí£");
            Scanner sc = new Scanner(System.in);
            String s = "";
            s = sc.nextLine();
            if (s.equals("Oui")) {                                              //Si c'est le cas, alors on r√©appelle la m√©thode Start() afin de r√©afficher le menu du d√©but
                Start();
            } else {
                System.exit(0);                                                 //Sinon on met fin au programme
            }

        }

    }

    public String ChoisirCaseX() {                                                                              //Notre m√©thode ChoisirCaseX() permet un affichage correct 
        Scanner sc = new Scanner(System.in);                                                                    //Il v√©rifie avec les REGEX que ce soit un nombre
        System.out.println("====================Veuillez saisir une coordonn√©e en X:====================");
        String str = "";
        do {
            str = sc.nextLine();
        } while (!str.matches("[0-9]+"));
        return str;
    }

    public String ChoisirCaseY() {                                                                              //La m√™me chose est ainsi faite pour cette m√©thode
        Scanner sc = new Scanner(System.in);
        System.out.println("====================Veuillez saisir une coordonn√©e en Y:====================");
        String str = "";
        do {
            str = sc.nextLine();
        } while (!str.matches("[0-9]+"));
        return str;
    }

}
